env:
  global:
    - tf_version=0.13.5
    - CLOUDSDK_CORE_DISABLE_PROMPTS=1
    - secure: tRyZZbsu/xUKYejAObxaWtuavgnjEpxecBn6bpt5Pq7+9dM1URLsNDvpwV4mf4rKbpN9cIQ6xqpLZePiPJPZwkBmvFnnKSMOxUGomo0clSaGAeHkx6yIILgLYwDRJTgjOeV7Cbl3x5ftrcZIIm8rcz7HCo6iB95DfxudfuZOX8D09OhTbFKHMqg1MjzXVF+RV3sYYuxb/P644sfVdQGCt/lKFNA3MzE8p86SNMAag8g9gA95p/CeLnYpKKNx6mkfbILfZm7kJ2OKjBQncEEXdYXgfesaQ0rF9rNUl03RBHvL/Y2Ahvc/18Lv7iNzp1rR0XfF4UHoxiQd0d6rRxm83SxQarhReqDdWB2Q+UNSnU3c5BTgiGsHZYXvIDPOnk5Oi8RCQl24XlyrQsI2uxg3if8MXIH5tuQwlrxZkySivCabuy02kUjPqaHZ7Mu5W2bIfr3+eeelhitZVnctyvpSjRtsLoUZFmauXbVoxnwpcFd8t+k6iN7vvswJloSN+o7+Xujgkjy5RpgKhFCpq/Zd5OwCIqRTARNRNi27lzQYA7q7sUpA2iZhx7IIAYbyZ1bkKOmUWku9yC1ebM4UHJY/zXlB1AjQ5VejJNY139ajVi6jpzyti/nmemngYr0l0PVT2yAjSIiAlc2m6se68Wm1ILSYumngjyzJime27bCeyys=
    - secure: UOEr8Ngce8ypZ71iXbCJ/XrKHWrv98KhAHSLiYUOoEMYht60llVBot1wy+imUiOktBnDV+mIJelsTDs0JN/1kgaS8ACMMOANq2Y3BMR6bgycpvedC2MIECaX/meSAfb05y9LJJIWNkfW2GjZ9uCcVg7huOwscvjFDid2+O4uQlPlYnUgkkwqK5iyDUTJzQg6ueYhl8BFtxwaqiict1TpJbh/qQKMhuIRzwdm3s5O4O9rehXDSCn1e/ej0vEge1PJck3+9AmczBeEt+W1SDEP00weVo6uErWpyQk3VhK+UtB3zFSvdt5vRQw8nt6uWF9E3d5Be20e27gMfe2xHR/GxQGdQwsWpzdRjhrGcLJJXS6djtCqpGXasW5Dmd/yyRjDx/6L8GLatbrkwVa8guorC/3Ean9UY2KgHX3gu7Xe5gmGn6MxQgx3pCTxQbl1QoenKOGOklaeumXUo0IKx/A/Jy9av/R1JVtS39nBcieR4/5eGHQwu2jjk+diDAJiJVnFMJO+dNMc/ORfmaEamtVrFWfQDdOvsrnmXPuCixJCELgzYJBgEdcjoJpT4KANiEpEuz4FSMD/sBPI4Dc81kN1FggjAjB68jlueCyA3qKTHYDT/fFqG0rl62xL4LOH/y0YNNMpJbs1RKAf1FnhlnxiKI0ef3wiXN02t+tOVCywKAk=
    - secure: QW77woizuAFL5rSW77VMWuDQGYhnpqwmk+iWVFAnCsLlhOwI/y8YmyoJegOHLaU61/JSRVvUxPdIO7hXeRXeXhbyAT96cG1nP2v4LE0YD1wWLnM5z+l9ytU/81qab0Tz0ZBEnrtAQwT8oCEEWYZsCAy/srOona+KX9Rc2UixiN4QvtySYt8h7u71gZa5I09aZPEvV/9C8QLYXJxVoFCmoZ7+r5eua5DUe4PA/uSl48qFSYfK15JK+3tEP2SBis0ABJ9olBdjFtxMQlDevxLbQIwlNdoZnSRB0kvD9MJPcA0lpKHplVKWSpcIBsldJaTAbzAkCHcw4yEVAzu/FK8FrqHlIn6Ty3YUt2WzY6BVSiacOTPHvwz52CHbEpuCiOX5ZjyLjkeuQBzeQXfBoTZ1oKJwnCM5J43SJpirkhD8bCoSu0ahYq5UZRaVdYhVUecRJrdjGWbDJ/MqsMERwt1VC9BNKCwKCTdD7GHvYYwYzPihcB9cvtqmEELHB42SpkaJTokaZMjwmpNM4CGMmiFaPH0/3V8yV0x974zMNihspviV67ZwisBc5nIjyDhda2egT8DJXeiFUKq56wEsHE4jPKH4WkQVzv2Q0zlVGYvDaBIfkVWBGSjOGUD2+tf8GDvELWQvmBzleGOJAomsY+b2+yrKRAbsoscWOCAwKWwZRwc=
    - secure: t+hjejHv8ruk/HUB1lvAgm+EqHXIH2uLnGGpCDVPd6WFstMvjXu0J7gh7Y7RZNdASrZf4uCmDALVCSiUtD/TmBYgIkrzalYnY45rPSo7/e+9oScrkPquolhRvEc1nXA8mgxjUcibugRRJZzQCszQw3KSDZSjbU4BY8a7ut+g2t561SVeuhB407LT/2rIGuKMhuCBHGetmJP8Uk6SDL9E9wKQjtHmdYFuz734ju4B42Sy2GDruh3ezHvvR9ikLCuONgAKlGBRRYMMDuxg5cvSktP/i56M8t/Hj4s144IQ0/KP96migeOYnCSYaQiDcxo6JWn00d7XY9SiSDer3q5+gO74DmfgotO6TM81iHTFvClbQeRWIeBGQfGwJe+hcVrkYBNCLT+lIB+4iJVBDdWCG3/s7znZfZ6d/ABOljc8go9x+tKTVKEzuqTqzB2iTXDeHlzG6sFiuNtC1iNzqY+cLxll41tWrQy4DZ9Qszu3AAD2lIW5XG6QqjOr0kgXHDkymXKP51VaeehYXV939OqQTqDfTRMfYu028ycIHz/MZTp1zM0N5TKCSTrMatQi1pJPpwF+ur5kzFmuai5u6Jm2SanB9aritz8Yd3aM2zJFsxES57SlZ+VokfE0Buoh0lxBWwlY3pXw4GqEKismHqrSSIjZRVWLkn2sIVquWNxaJRg=
    - secure: tQR/I9OsFWIT03+nPYl9aQ4OUJFkQPyDokZlB7sy5JICK8a1t4M05tx1/IRVqeOFj/lqHzs5c54zIHZXMYvdGIQDrp+8iB1jsRs2DK0BAhpw+fJZzvDJsQvhyHeYrUNZb0WApdIDlvrY864UTY2tPlDA9aBQ1fhemubWo7RFZT+dUl/gtpCMgStz+CGpxnDqdmS3VRivU1ybmWsHbEoZ9tEKihhv7ayORK3WMeALX7FMAtkxop68KinBeOp5V0UiPlTIO9Aj37WByfmZ1DYH93XNDi+6icPrvFeJwnjvXu82IPlhXkeov9xt7vKWe8a4zSmH73GOrkJeNt233q9NFVzYlOZLr4v2a+YhS+0xzQBMRtdtnfozbqIoRWJ9AacGJ2zRdIWni19UIOHyO4u7y3EPpYoKhMmM7AEtuiyDrgap6gTQh5aB3N/PL1KFIBhtA2ZvpM9qm4izXdKv2p984b8d2eckHZi/bmacYP1ycJxVVmfCW3lQ12Jmv/i6/BEcvHtP7nWu236zoAIOEa4c6ZaveJbVBLYySSzLJ1dur+hjin8L34TYdpujknjCUEpwgODFyUuAKyXE7M6gZ5lrqEogfKdqDVYAtrrNPWTM8TMwYvlZVxMeknJm4arsNgW+LJkvY+E8GGdLvtz69TlgnEYAFve0buvY2iAPlLK2nZ8=
branches:
  only:
    - main
before_install:
  - openssl aes-256-cbc -K $encrypted_3bf60d793673_key -iv $encrypted_3bf60d793673_iv -in terraform.json.enc -out terraform.json -d
  - curl https://sdk.cloud.google.com | bash > /dev/null
  - source "$HOME/google-cloud-sdk/path.bash.inc"
  - gcloud auth activate-service-account --key-file=terraform.json
  - gcloud config set project "${GCP_PROJECT_ID}"
  - export GOOGLE_APPLICATION_CREDENTIALS=./terraform.json
  - wget https://releases.hashicorp.com/terraform/"$tf_version"/terraform_"$tf_version"_linux_amd64.zip
  - unzip terraform_"$tf_version"_linux_amd64.zip
  - sudo mv terraform /usr/local/bin/
  - rm terraform_"$tf_version"_linux_amd64.zip
install: true
script:
- |-
  set -ex;
  export TF_VAR_logz_url=$LOGZ_URL
  export TF_VAR_logz_token=$LOGZ_TOKEN
  export TF_VAR_statuscake_apikey=$STATUSCAKE_APIKEY
  export TF_VAR_statuscake_username=$STATUSCAKE_USERNAME
  export TF_VAR_project_id=$GCP_PROJECT_ID
  terraform init
  terraform plan
  terraform apply --auto-approve
  terraform output